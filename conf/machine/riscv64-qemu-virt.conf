#@TYPE: Machine
#@NAME: riscv64-qemu-virt
#@DESCRIPTION: RISC-V 64-bit QEMU virt machine for StarryOS/ArceOS

# 基础架构配置
require conf/machine/include/riscv/tune-riscv.inc
require conf/machine/include/qemu.inc

# ArceOS 通用配置
require conf/machine/include/arceos-machine-common.inc

# ==================== ArceOS/StarryOS 必须变量 ====================
# 对应 Makefile: ARCH, PLAT_NAME, MYPLAT, TARGET
ARCEOS_ARCH = "riscv64"
ARCEOS_PLATFORM = "riscv64-qemu-virt"
ARCEOS_PLAT_PACKAGE = "axplat-riscv64-qemu-virt"
RUST_TARGET = "riscv64gc-unknown-none-elf"

# ==================== RISC-V 架构配置 ====================
DEFAULTTUNE = "riscv64"
TUNE_ARCH = "riscv64"
TUNE_PKGARCH = "riscv64"

# ==================== 平台默认值 ====================
ARCEOS_SMP ?= "4"

# ==================== QEMU 配置 ====================
QB_SYSTEM_NAME = "qemu-system-riscv64"
QB_MACHINE = "-machine virt"
QB_CPU = "-cpu rv64"
QB_MEM = "-m 2048"
QB_SMP = "-smp ${ARCEOS_SMP}"
QB_KERNEL_CMDLINE_APPEND = "console=ttyS0"
QB_DTB = ""

SERIAL_CONSOLES = "115200;ttyS0"
